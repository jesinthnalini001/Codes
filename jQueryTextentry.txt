Qualtrics.SurveyEngine.addOnload(function() {
  // Replace "QR~QID616" with the actual textarea ID
  var $textArea = jQuery("#QR~QID616");
  var $charCountSpan = jQuery("#QID616-RemainingChars");

  // Initially hide the character count
  $charCountSpan.hide();

  $textArea.on("input", function() {
    var text = $textArea.val();
    var charCount = text.length;
    var remainingChars = 300 - charCount;

    if (charCount >= 10) {
      // Show the character count if 10 or more characters have been entered
      $charCountSpan.show();
      // Set the "aria-live" attribute to "polite" to announce changes to the live region
      $charCountSpan.attr("aria-live", "polite");
    } else {
      // Hide the character count if fewer than 10 characters have been entered
      $charCountSpan.hide();
      // Set the "aria-live" attribute to "off" to stop announcements when hidden
      $charCountSpan.attr("aria-live", "off");
    }

    // Update the remaining character count
    $charCountSpan.find("span[data-runtime-text='runtime.CharsRemaining']").text(remainingChars);
  });
});
