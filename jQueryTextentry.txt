Qualtrics.SurveyEngine.addOnload(function() {
  // Create a placeholder to display the reminder message
  var char_rem = document.createElement("p");
  char_rem.setAttribute("id", "char_reminder");
  char_rem.setAttribute("style", "color: LightGray;");
  this.getChoiceContainer().parentNode.appendChild(char_rem);
});

Qualtrics.SurveyEngine.addOnReady(function() {
  var that = this;
  var qid = this.questionId;
  var inputSelector = 'QR~' + qid;

  // Set the default max_len to 300 characters
  var max_len = 300;

  // Get the input element using the appropriate selector
  var inputElement = document.querySelector('input[name="' + inputSelector + '"]');

  // Check if the input element exists before adding the event listener
  if (inputElement) {
    inputElement.addEventListener('input', function() {
      limited();
    });
  }

  function limited() {
    if (!inputElement) {
      return; // Exit the function if the input element doesn't exist
    }

    var curr_len = inputElement.value.length;
    var reminder = "";

    if (curr_len > 10) {
      var rem_len = max_len - curr_len;
      reminder = rem_len + "/300 characters remaining";
    }

    document.querySelector("#char_reminder").innerText = reminder;
  }
});
