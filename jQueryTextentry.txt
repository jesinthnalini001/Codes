Qualtrics.SurveyEngine.addOnload(function() {
  // Replace "QR~QID616" with the actual textarea ID
  var $textArea = jQuery("#QR~QID616");
  var $charCountSpan = jQuery("#QID616-RemainingChars");

  // Initially hide the character count and mark it as hidden from screen readers
  $charCountSpan.hide().attr("aria-hidden", "true");

  $textArea.on("input", function() {
    var text = $textArea.val();
    var charCount = text.length;
    var remainingChars = 300 - charCount;

    if (charCount >= 10) {
      // Show the character count if 10 or more characters have been entered
      $charCountSpan.show().removeAttr("aria-hidden");
    } else {
      // Hide the character count and mark it as hidden from screen readers if fewer than 10 characters have been entered
      $charCountSpan.hide().attr("aria-hidden", "true");
    }

    // Update the remaining character count
    $charCountSpan.find("span[data-runtime-text='runtime.CharsRemaining']").text(remainingChars);
  });
});
